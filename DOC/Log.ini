Log inicial:
"
==============================================================================
VPC3+S PROFIBUS Slave - Standard Initialization Approach
==============================================================================

Using standard DpAppl_ProfibusInit() for complete initialization

Performing VPC3+S hardware reset...
Hardware reset completed.
Reading initial VPC3+ status...
Status Register (hi,low): 0xE304

Forcing VPC3+ to OFFLINE state...
Status before GO_OFFLINE: 0x04
Status after GO_OFFLINE: 0x04
SUCCESS: VPC3+ is now in OFFLINE state

Initializing PROFIBUS with configuration:
VPC3+S REGISTERS:
STATUS_L   (0x04): 0x04
STATUS_H   (0x05): 0xE3
MODE_REG_1 (0x07): 0x37
CONTROL_REG(0x08): 0x27
MODE_REG_2 (0x09): 0x01
INT_REG_L  (0x0A): 0x39
INT_REG_H  (0x0B): 0x0E
CFG_PTR    (0x34): 0x00

- Slave Address: 7 (0x07)
- Ident Number:  0xADAC
- GSD File:      Profibus.gsd

DEBUG: [DpCfg_Init] sDpAppl.sCfgData.abData inicializado: 0x20 0x10
DEBUG: [VPC3_MemoryTest] INICIO - Probando memoria VPC3+S
DEBUG: [VPC3_MemoryTest] ASIC_RAM_LENGTH = 0x0400
DEBUG: [VPC3_MemoryTest] INIT_VPC3_MODE_REG_2 = 0x05
DEBUG: [VPC3_MemoryTest] MODE_REG_2 configurado: 0x02
DEBUG: [VPC3_MemoryTest] Iniciando escritura de memoria...
DEBUG: [VPC3_MemoryTest] bVpc3RwTsAddr = 0x0016
DEBUG: [VPC3_MemoryTest] Contenido inicial de memoria:
DEBUG: [VPC3_MemoryTest] Addr 0x0016: 0x82 0x7C
DEBUG: [VPC3_MemoryTest] Addr 0x0018: 0x00 0x00
DEBUG: [VPC3_MemoryTest] Addr 0x001A: 0x00 0x00
DEBUG: [VPC3_MemoryTest] Addr 0x001C: 0x00 0x00
DEBUG: [VPC3_MemoryTest] Addr 0x001E: 0x00 0x00
DEBUG: [VPC3_MemoryTest] Escribiendo primeros 10 bytes como prueba...
DEBUG: [VPC3_MemoryTest] Escribiendo addr 0x0016: high=0x00, low=0x00
DEBUG: [VPC3_MemoryTest] Verificación addr 0x0016: escrito=(0x00,0x00), leído=(0x00,0x00)
DEBUG: [VPC3_MemoryTest] Escribiendo addr 0x0018: high=0x00, low=0x01
DEBUG: [VPC3_MemoryTest] Verificación addr 0x0018: escrito=(0x00,0x01), leído=(0x00,0x01)
DEBUG: [VPC3_MemoryTest] Escribiendo addr 0x001A: high=0x00, low=0x02
DEBUG: [VPC3_MemoryTest] Verificación addr 0x001A: escrito=(0x00,0x02), leído=(0x00,0x02)
DEBUG: [VPC3_MemoryTest] Escribiendo addr 0x001C: high=0x00, low=0x03
DEBUG: [VPC3_MemoryTest] Verificación addr 0x001C: escrito=(0x00,0x03), leído=(0x00,0x03)
DEBUG: [VPC3_MemoryTest] Escribiendo addr 0x001E: high=0x00, low=0x04
DEBUG: [VPC3_MemoryTest] Verificación addr 0x001E: escrito=(0x00,0x04), leído=(0x00,0x04)
DEBUG: [VPC3_MemoryTest] Continuando escritura del resto de memoria...
DEBUG: [VPC3_MemoryTest] Escritura completada
DEBUG: [VPC3_MemoryTest] Iniciando lectura de memoria...
DEBUG: [VPC3_MemoryTest] Lectura completada, bError=1
DEBUG: [VPC3_MemoryTest] FIN - Resultado: 1 (0x01)
DEBUG: VPC3_Initialization - INICIO
DEBUG: pVpc3 = 0x20000120
DEBUG: Estructura pVpc3 inicializada con ceros? bReadCfgBufPtr=0x00
DEBUG: Verificando estado OFFLINE...
DEBUG: VPC3 esta en OFFLINE, continuando...
DEBUG: Configurando MODE_REG_2...
DEBUG: Limpiando memoria VPC3 (4074 bytes)...
DEBUG: Memoria VPC3 limpiada exitosamente
DEBUG: Configurando valores constantes...
DEBUG: [VPC3_SetConstants] Escribiendo registros de modo...
DEBUG: [VPC3_SetConstants] Escribiendo MODE_REG_0_H: 0x25
DEBUG: [VPC3_SetConstants] Escribiendo MODE_REG_0_L: 0xC0
DEBUG: [VPC3_SetConstants] Escribiendo MODE_REG_2: 0x05
DEBUG: [VPC3_SetConstants] Escribiendo MODE_REG_3: 0x00
DEBUG: [VPC3_SetConstants] Verificando configuración de registros de modo...
DEBUG: [VPC3_SetConstants] MODE_REG_0_H configurado: 0x25 (esperado: 0x25)
DEBUG: [VPC3_SetConstants] MODE_REG_0_L configurado: 0xC0 (esperado: 0xC0)
DEBUG: [VPC3_SetConstants] MODE_REG_2 configurado: 0x09 (esperado: 0x05)
DEBUG: [VPC3_SetConstants] MODE_REG_3 configurado: 0x93 (esperado: 0x00)
DEBUG: Valores constantes OK, calculando longitudes I/O...
DEBUG: Longitudes I/O calculadas OK, inicializando buffers...
DEBUG: === CADENA DE ASIGNACIONES DE PUNTEROS ===
DEBUG: VPC3_DP_BUF_START=10
DEBUG: wOutBufferLength=8, wInBufferLength=8, wDiagBufferLength=16
DEBUG: abDoutBufPtr[0]=0x0A
DEBUG: abDoutBufPtr[1]=0x0B
DEBUG: abDoutBufPtr[2]=0x0C
DEBUG: abDinBufPtr[0]=0x0D
DEBUG: abDinBufPtr[1]=0x0E
DEBUG: abDinBufPtr[2]=0x0F
DEBUG: abDiagBufPtr[0]=0x10
DEBUG: abDiagBufPtr[1]=0x12
DEBUG: wCfgBufferLength=8, SEG_MULDIV=3, (wCfgBufferLength >> SEG_MULDIV)=1
DEBUG: bCfgBufPtr=0x14
DEBUG: ANTES de asignacion: bReadCfgBufPtr=0x00
DEBUG: Calculando: 0x14 + 1 = 0x15
DEBUG: DESPUES de asignacion: bReadCfgBufPtr=0x15
DEBUG: Verificando direccion: &(pVpc3->bReadCfgBufPtr)=0x20000154
DEBUG: Valor directo en direccion: *(&(pVpc3->bReadCfgBufPtr))=0x15
DEBUG: Buffers inicializados OK, configurando servicios...
DEBUG: Copiando estructura de sistema (0x2A bytes)...
DEBUG: Desde pVpc3->bTsAddr (0x20000136) hacia VPC3 addr 0x0016
DEBUG: Valor de bReadCfgBufPtr en estructura local: 0x15
DEBUG: Offset de bReadCfgBufPtr desde bTsAddr: 0x1E
DEBUG: Estructura de sistema copiada OK
DEBUG: Configurando longitud de configuracion (2 bytes)...
DEBUG: Longitud configurada OK
DEBUG: Obteniendo puntero del buffer de configuracion...
DEBUG: Leyendo registro 0x34 del VPC3+: 0x15
DEBUG: Puntero del buffer: 0x000000A8
DEBUG: Copiando datos de configuracion...
DEBUG: Datos de configuracion copiados OK
DEBUG: Configuracion final copiada exitosamente
DEBUG: VPC3_Initialization - FIN con resultado: 0x01
DEBUG: VPC3_Start - INICIO
DEBUG: Verificando estado antes del START...
DEBUG: STATUS_L pre-START: 0x04
DEBUG: OK - Chip está en OFFLINE (bit 0 = 0)
DEBUG: Enviando comando START (0x01) al registro de control (0x08)...
DEBUG: Esperando que el chip procese el comando START...
DEBUG: Esperando estabilización adicional del chip...
DEBUG: Reconfigurando registros de modo después del START...
DEBUG: Esperando a que los registros de modo se procesen...
DEBUG: Verificando estado después del comando START...
DEBUG: STATUS_L post-START: 0x91
DEBUG: EXITO - Chip ha entrado en Passive_Idle (bit 0 = 1)
DEBUG: Obteniendo puntero del buffer de diagnostico...
DEBUG: [VPC3_GetDiagBufPtr] bDiagBufferSm=0x0D
DEBUG: [VPC3_GetDiagBufPtr] pDiagBuffer1=0x00000080, pDiagBuffer2=0x00000090
DEBUG: [VPC3_GetDiagBufPtr] Seleccionado pDiagBuffer1
DEBUG: [VPC3_GetDiagBufPtr] Retornando puntero: 0x00000080
DEBUG: Puntero del buffer de diagnostico: 0x00000080
DEBUG: [VPC3_Start] Verificando estado final después del START...
DEBUG: [VPC3_Start] STATUS_L final: 0x91
DEBUG: [VPC3_Start] STATUS_H final: 0xE3
DEBUG: [VPC3_Start] MODE_REG_1 final: 0x25
DEBUG: [VPC3_Start] PASS_IDLE check: OK
DEBUG: VPC3_Start - FIN
PROFIBUS initialization completed successfully!

Reading final VPC3+ status...
VPC3+S REGISTERS:
STATUS_L   (0x04): 0x91
STATUS_H   (0x05): 0xE3
MODE_REG_1 (0x07): 0x25
CONTROL_REG(0x08): 0x93
MODE_REG_2 (0x09): 0x02
INT_REG_L  (0x0A): 0x1E
INT_REG_H  (0x0B): 0x0F
CFG_PTR    (0x34): 0x15

Status Register (hi,low): 0xE391

Entering main operation loop...
The PROFIBUS slave is now ready for master communication.

================= PLC CONFIGURATION REQUIRED =================
1. Load GSD file:     Profibus.gsd
2. Set slave address: 7 (0x07)
3. Connect PROFIBUS cable and activate communication
================================================================

DEBUG: [CopyFromVpc3] Lectura de 0x00C0, longitud 10
DEBUG: [CopyFromVpc3] Datos leídos: 0xB8 0x02 0x02 0x0B 0xAD 0xAC 0x00 0x00 0x00 0x00
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFC, bSeqNr=0x00, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFC00
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFC00) con pDpSystem->wOldDiag (0x0000)
DEBUG: [DpDiag_Alarm] wDiagEvent != wOldDiag, continuando...
DEBUG: [DpDiag_Alarm] Verificando VPC3_GetDpState(eDpStateDiagActive): 0
DEBUG: [DpDiag_Alarm] Estado diagnóstico NO activo, procediendo...
DEBUG: [DpDiag_Alarm] Procesando bAlarmType=0xFC en switch...
DEBUG: [DpDiag_Alarm] Caso default/otros
DEBUG: [DpDiag_Alarm] Después del switch: bDiagLength=0, bExtDiagFlag=0x00
DEBUG: [DpDiag_Alarm] Estado diagnóstico activado
DEBUG: [DpDiag_Alarm] Llamando VPC3_SetDiagnosis con bDiagLength=0, bExtDiagFlag=0x00, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Contenido del buffer de diagnóstico (0 bytes):
DEBUG: [VPC3_SetDiagnosis] INICIO - bUserDiagLength=0, bDiagControl=0x00, bCheckDiagFlag=0
DEBUG: [VPC3_SetDiagnosis] Verificando VPC3_CheckDiagBufPtr()...
DEBUG: [VPC3_SetDiagnosis] Buffer de diagnóstico disponible
DEBUG: [VPC3_SetDiagnosis] bDpState=0x00, DATA_EX=0x02
DEBUG: [VPC3_SetDiagnosis] Verificando longitud: bUserDiagLength=0, DIAG_BUFSIZE-6=10
DEBUG: [VPC3_SetDiagnosis] Verificando bDiagControl=0x00...
DEBUG: [VPC3_SetDiagnosis] Caso default para bDiagControl
DEBUG: [VPC3_SetDiagnosis] Verificando contenido del buffer de diagnóstico...
DEBUG: [VPC3_SetDiagnosis] Llamando VPC3_UpdateDiagnosis...
DEBUG: [VPC3_SetDiagnosis] VPC3_UpdateDiagnosis completado
DEBUG: [VPC3_SetDiagnosis] FINAL - Retornando bRetValue=1
DEBUG: [DpDiag_Alarm] VPC3_SetDiagnosis retornó: 1
DEBUG: [DpDiag_Alarm] VPC3_SetDiagnosis exitoso, actualizando wOldDiag
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=1
DEBUG: [CopyFromVpc3] Lectura de 0x00D0, longitud 2
DEBUG: [CopyFromVpc3] Datos leídos: 0x20 0x10
DEBUG: [dp_isr] Contenido de abPrmCfgSsaHelpBuffer JUSTO ANTES de DpCfg_ChkNewCfgData (2 bytes): 0x20 0x10
DEBUG: Chk_Cfg recibido. Longitud: 2 bytes. Contenido (copia local): 0x20 0x10
DEBUG: [DpDiag_SetCfgOk] Entrando con eCfgError=0
DEBUG: [DpDiag_SetCfgOk] eRetValue inicializado como eCfgError=0
DEBUG: [DpDiag_SetCfgOk] MAX_DIAG_RETRY=10
DEBUG: [DpDiag_SetCfgOk] Intento 1: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [VPC3_GetDiagBufPtr] bDiagBufferSm=0x07
DEBUG: [VPC3_GetDiagBufPtr] pDiagBuffer1=0x00000080, pDiagBuffer2=0x00000090
DEBUG: [VPC3_GetDiagBufPtr] Seleccionado pDiagBuffer2
DEBUG: [VPC3_GetDiagBufPtr] Retornando puntero: 0x00000090
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFC00)
DEBUG: [DpDiag_Alarm] wDiagEvent != wOldDiag, continuando...
DEBUG: [DpDiag_Alarm] Verificando VPC3_GetDpState(eDpStateDiagActive): 0
DEBUG: [DpDiag_Alarm] Estado diagnóstico NO activo, procediendo...
DEBUG: [DpDiag_Alarm] Procesando bAlarmType=0xFD en switch...
DEBUG: [DpDiag_Alarm] Caso USER_TYPE_CFG_OK/NOK
DEBUG: [DpDiag_Alarm] bExtDiagFlag configurado: 0x02
DEBUG: [DpDiag_AddIdentRelDiagBlock] Copiando 2 bytes: 0x42 0x3C
DEBUG: [DpDiag_Alarm] Después de AddIdentRelDiagBlock: bDiagLength=2
DEBUG: [DpDiag_AddModuleStatDiagBlock] Copiando 6 bytes: 0x06 0x82 0x00 0x00 0xA0 0x0A
DEBUG: [DpDiag_Alarm] Después de AddModuleStatDiagBlock: bDiagLength=8
DEBUG: [DpDiag_Alarm] Después del switch: bDiagLength=8, bExtDiagFlag=0x02
DEBUG: [DpDiag_Alarm] Estado diagnóstico activado
DEBUG: [DpDiag_Alarm] Llamando VPC3_SetDiagnosis con bDiagLength=8, bExtDiagFlag=0x02, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Contenido del buffer de diagnóstico (8 bytes): 0x42 0x3C 0x06 0x82 0x00 0x00 0xA0 0x0A
DEBUG: [VPC3_SetDiagnosis] INICIO - bUserDiagLength=8, bDiagControl=0x02, bCheckDiagFlag=0
DEBUG: [VPC3_SetDiagnosis] Verificando VPC3_CheckDiagBufPtr()...
DEBUG: [VPC3_SetDiagnosis] Buffer de diagnóstico disponible
DEBUG: [VPC3_SetDiagnosis] bDpState=0x00, DATA_EX=0x02
DEBUG: [VPC3_SetDiagnosis] Verificando longitud: bUserDiagLength=8, DIAG_BUFSIZE-6=10
DEBUG: [VPC3_SetDiagnosis] Verificando bDiagControl=0x02...
DEBUG: [VPC3_SetDiagnosis] Caso default para bDiagControl
DEBUG: [VPC3_SetDiagnosis] Verificando contenido del buffer de diagnóstico...
DEBUG: [VPC3_SetDiagnosis] Procesando header: 0x42, DIAG_TYPE_MASK=0xC0
DEBUG: [VPC3_SetDiagnosis] Caso DIAG_TYPE_KEN
DEBUG: [VPC3_SetDiagnosis] bTmpLength=2
DEBUG: [VPC3_SetDiagnosis] bTmpLength=2, bTmpUserDiagnosisLength=8
DEBUG: [VPC3_SetDiagnosis] Procesando header: 0x06, DIAG_TYPE_MASK=0xC0
DEBUG: [VPC3_SetDiagnosis] Caso DIAG_TYPE_DEV
DEBUG: [VPC3_SetDiagnosis] bTmpLength=6, STATUS_DIAG_HEAD_SIZE=4
DEBUG: [VPC3_SetDiagnosis] bTmpLength=6, bTmpUserDiagnosisLength=6
DEBUG: [VPC3_SetDiagnosis] Llamando VPC3_UpdateDiagnosis...
DEBUG: [VPC3_SetDiagnosis] VPC3_UpdateDiagnosis completado
DEBUG: [VPC3_SetDiagnosis] FINAL - Retornando bRetValue=1
DEBUG: [DpDiag_Alarm] VPC3_SetDiagnosis retornó: 1
DEBUG: [DpDiag_Alarm] VPC3_SetDiagnosis exitoso, actualizando wOldDiag
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=1
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm exitoso en intento 1
DEBUG: [DpDiag_SetCfgOk] eRetValue ANTES del break: 0
DEBUG: [DpDiag_SetCfgOk] Bucle terminado. bLoop=1
DEBUG: [DpDiag_SetCfgOk] eRetValue FINAL: 0
DEBUG: [DpDiag_SetCfgOk] eCfgError original: 0
DEBUG: [DpDiag_SetCfgOk] ¿Debería retornar eCfgError en lugar de eRetValue? NO
DEBUG: [DpDiag_SetCfgOk] Retornando eRetValue=0
EVENT: Chk_Cfg recibido y aceptado (DP_CFG_OK)
DEBUG: [ChkCfg] dentro del if OK eRetValue=0
DEBUG: Configuración esperada local (2 bytes): 0x20 0x10
DEBUG: [ChkCfg] Finalizando con eRetValue=0
DEBUG: [CopyFromVpc3] Lectura de 0x00A0, longitud 2
DEBUG: [CopyFromVpc3] Datos leídos: 0x20 0x10
DEBUG: [dp_isr] Contenido de abPrmCfgSsaHelpBuffer JUSTO ANTES de DpCfg_ChkNewCfgData (2 bytes): 0x20 0x10
DEBUG: Chk_Cfg recibido. Longitud: 2 bytes. Contenido (copia local): 0x20 0x10
DEBUG: [DpDiag_SetCfgOk] Entrando con eCfgError=0
DEBUG: [DpDiag_SetCfgOk] eRetValue inicializado como eCfgError=0
DEBUG: [DpDiag_SetCfgOk] MAX_DIAG_RETRY=10
DEBUG: [DpDiag_SetCfgOk] Intento 1: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [VPC3_GetDiagBufPtr] bDiagBufferSm=0x0D
DEBUG: [VPC3_GetDiagBufPtr] pDiagBuffer1=0x00000080, pDiagBuffer2=0x00000090
DEBUG: [VPC3_GetDiagBufPtr] Seleccionado pDiagBuffer1
DEBUG: [VPC3_GetDiagBufPtr] Retornando puntero: 0x00000080
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 1
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Intento 2: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 2
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Intento 3: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 3
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Intento 4: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 4
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Intento 5: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 5
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Intento 6: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 6
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Intento 7: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 7
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Intento 8: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 8
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Intento 9: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 9
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Intento 10: Llamando DpDiag_Alarm...
DEBUG: [DpDiag_SetCfgOk] Parámetros: USER_TYPE_CFG_OK=253, 0x22, VPC3_NULL_PTR, VPC3_FALSE
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFD, bSeqNr=0x22, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFD22
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFD22) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent == wOldDiag, retornando DP_DIAG_SAME_DIAG
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=103
DEBUG: [DpDiag_SetCfgOk] DpDiag_Alarm falló en intento 10
DEBUG: [DpDiag_SetCfgOk] eRetValue después del fallo: 0
DEBUG: [DpDiag_SetCfgOk] Bucle terminado. bLoop=11
DEBUG: [DpDiag_SetCfgOk] eRetValue FINAL: 0
DEBUG: [DpDiag_SetCfgOk] eCfgError original: 0
DEBUG: [DpDiag_SetCfgOk] ¿Debería retornar eCfgError en lugar de eRetValue? NO
DEBUG: [DpDiag_SetCfgOk] Retornando eRetValue=0
EVENT: Chk_Cfg recibido y aceptado (DP_CFG_OK)
DEBUG: [ChkCfg] dentro del if OK eRetValue=0
DEBUG: Configuración esperada local (2 bytes): 0x20 0x10
DEBUG: [ChkCfg] Finalizando con eRetValue=0
DEBUG: [dp_isr] IND_DX_OUT detectado - procesando Data Exchange Output
DEBUG: [dp_isr] STATUS antes de DpAppl_IsrDxOut: L=0x45, H=0xE3
DEBUG: [dp_isr] STATUS_L antes: 0x45 (esperado DATA_EX=0x45)
DEBUG: [dp_isr] STATUS_H antes: 0xE3 (esperado 0xE3)
DEBUG: [DpAppl_IsrDxOut] INICIO - Configurando evento IoOut
DEBUG: [DpAppl_IsrDxOut] FIN - Evento IoOut configurado
DEBUG: [dp_isr] STATUS después de DpAppl_IsrDxOut: L=0x45, H=0xE3
DEBUG: [dp_isr] STATUS_L después de DpAppl_IsrDxOut: 0x45
DEBUG: [dp_isr] STATUS_H después de DpAppl_IsrDxOut: 0xE3
DEBUG: [dp_isr] STATUS después de VPC3_CON_IND_DX_OUT: L=0x45, H=0xE3
DEBUG: [dp_isr] STATUS_L después de VPC3_CON_IND_DX_OUT: 0x45
DEBUG: [dp_isr] STATUS_H después de VPC3_CON_IND_DX_OUT: 0xE3
DEBUG: [dp_isr] IND_DX_OUT procesado
DEBUG: [STATUS_CHANGE] STATUS_L: 0xFF -> 0x45, STATUS_H: 0xFF -> 0xE3
DEBUG: [STATE_SWITCH] bDpState=0x02 (WAIT_PRM=0x00, WAIT_CFG=0x01, DATA_EX=0x02)
DEBUG: [STATE_CALC] STATUS_L=0x45, MASK_DP_STATE=0x60, cálculo=((0x45 & 0x60) >> 5)=0x02
DEBUG: [STATE_VERIFY] STATUS_L=0x45, bits 5-6 extraídos y desplazados: 0x02, debería ser DATA_EX=0x02
DEBUG: [STATE_ANALYSIS] STATUS_L=0x45 (binario: 01000101)
DEBUG: [STATE_ANALYSIS] MASK_DP_STATE=0x60 (binario: 01100000)
DEBUG: [STATE_ANALYSIS] STATUS_L & MASK_DP_STATE = 0x40 (binario: 01000000)
DEBUG: [STATE_ANALYSIS] (STATUS_L & MASK_DP_STATE) >> 5 = 0x02 (binario: 00000010)
DEBUG: [STATE_ANALYSIS] Comparación: bDpState=0x02 vs DATA_EX=0x02 (¿iguales? SÍ)
DEBUG: [STATE_CHANGE] DP_STATE cambió de 0xFF a 0x02
DEBUG: [STATE_DATA_EX] VPC3+ en DATA_EX - comunicación activa
DEBUG: [STATE_CHECK] eDpStateApplReady=0, eDpStateRun=2
DEBUG: [ProfibusMain] STATUS antes de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [DpAppl_CheckEvIoOut] Evento IoOut detectado, procesando...
DEBUG: [CopyFromVpc3] Lectura de 0x0050, longitud 1
DEBUG: [CopyFromVpc3] Datos leídos: 0x00
DEBUG: [ProfibusMain] STATUS después de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [ApplicationReady] INICIO - Configurando aplicación después de Chk_Cfg exitoso
DEBUG: [ApplicationReady] Llamando DpDiag_ResetStatDiag()...
DEBUG: [DpDiag_Alarm] INICIO - bAlarmType=0xFF, bSeqNr=0x00, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Constantes: USER_TYPE_CFG_OK=0xFD, STAT_DIAG_SET=0x02, EXT_DIAG_SET=0x01
DEBUG: [DpDiag_Alarm] wDiagEvent calculado: 0xFF00
DEBUG: [DpDiag_Alarm] VPC3_CheckDiagBufferChanged() completado
DEBUG: [DpDiag_Alarm] Comparando wDiagEvent (0xFF00) con pDpSystem->wOldDiag (0xFD22)
DEBUG: [DpDiag_Alarm] wDiagEvent != wOldDiag, continuando...
DEBUG: [DpDiag_Alarm] Verificando VPC3_GetDpState(eDpStateDiagActive): 0
DEBUG: [DpDiag_Alarm] Estado diagnóstico NO activo, procediendo...
DEBUG: [DpDiag_Alarm] Procesando bAlarmType=0xFF en switch...
DEBUG: [DpDiag_Alarm] Caso USER_TYPE_APPL_RDY
DEBUG: [DpDiag_AddIdentRelDiagBlock] Copiando 2 bytes: 0x42 0x3C
DEBUG: [DpDiag_AddModuleStatDiagBlock] Copiando 6 bytes: 0x06 0x82 0x00 0x00 0xA0 0x0A
DEBUG: [DpDiag_Alarm] Después del switch: bDiagLength=8, bExtDiagFlag=0x00
DEBUG: [DpDiag_Alarm] Estado diagnóstico activado
DEBUG: [DpDiag_Alarm] Llamando VPC3_SetDiagnosis con bDiagLength=8, bExtDiagFlag=0x00, bCheckDiagFlag=0
DEBUG: [DpDiag_Alarm] Contenido del buffer de diagnóstico (8 bytes): 0x42 0x3C 0x06 0x82 0x00 0x00 0xA0 0x0A
DEBUG: [VPC3_SetDiagnosis] INICIO - bUserDiagLength=8, bDiagControl=0x00, bCheckDiagFlag=0
DEBUG: [VPC3_SetDiagnosis] Verificando VPC3_CheckDiagBufPtr()...
DEBUG: [VPC3_SetDiagnosis] Buffer de diagnóstico disponible
DEBUG: [VPC3_SetDiagnosis] bDpState=0x40, DATA_EX=0x02
DEBUG: [VPC3_SetDiagnosis] Verificando longitud: bUserDiagLength=8, DIAG_BUFSIZE-6=10
DEBUG: [VPC3_SetDiagnosis] Verificando bDiagControl=0x00...
DEBUG: [VPC3_SetDiagnosis] Caso default para bDiagControl
DEBUG: [VPC3_SetDiagnosis] Verificando contenido del buffer de diagnóstico...
DEBUG: [VPC3_SetDiagnosis] Procesando header: 0x42, DIAG_TYPE_MASK=0xC0
DEBUG: [VPC3_SetDiagnosis] Caso DIAG_TYPE_KEN
DEBUG: [VPC3_SetDiagnosis] bTmpLength=2
DEBUG: [VPC3_SetDiagnosis] bTmpLength=2, bTmpUserDiagnosisLength=8
DEBUG: [VPC3_SetDiagnosis] Procesando header: 0x06, DIAG_TYPE_MASK=0xC0
DEBUG: [VPC3_SetDiagnosis] Caso DIAG_TYPE_DEV
DEBUG: [VPC3_SetDiagnosis] bTmpLength=6, STATUS_DIAG_HEAD_SIZE=4
DEBUG: [VPC3_SetDiagnosis] bTmpLength=6, bTmpUserDiagnosisLength=6
DEBUG: [VPC3_SetDiagnosis] Llamando VPC3_UpdateDiagnosis...
DEBUG: [VPC3_SetDiagnosis] VPC3_UpdateDiagnosis completado
DEBUG: [VPC3_SetDiagnosis] FINAL - Retornando bRetValue=1
DEBUG: [DpDiag_Alarm] VPC3_SetDiagnosis retornó: 1
DEBUG: [DpDiag_Alarm] VPC3_SetDiagnosis exitoso, actualizando wOldDiag
DEBUG: [DpDiag_Alarm] FINAL - Retornando bRetValue=1
DEBUG: [ApplicationReady] DpDiag_ResetStatDiag() exitoso, configurando estados
DEBUG: [ApplicationReady] Estados configurados: eDpStateCfgOkStatDiag=0, eDpStateApplReady=1, eDpStateRun=1
DEBUG: [ApplicationReady] FIN - Aplicación configurada
VPC3+S REGISTERS:
STATUS_L   (0x04): 0x45
STATUS_H   (0x05): 0xE3
MODE_REG_1 (0x07): 0x37
CONTROL_REG(0x08): 0x93
MODE_REG_2 (0x09): 0x02
INT_REG_L  (0x0A): 0x1E
INT_REG_H  (0x0B): 0x0F
CFG_PTR    (0x34): 0x9E

==============================================
PROFIBUS STATE: STATUS_L = 0x45 -> PASSIVE_IDLE
==============================================
[HEARTBEAT] El sistema está vivo. STATUS_L: 0x45
[INFO] Esperando telegrama Chk_Cfg del PLC...
[EVENT] Chk_Cfg recibido por el slave.
DEBUG: [VPC3_GetDiagBufPtr] bDiagBufferSm=0x06
DEBUG: [VPC3_GetDiagBufPtr] pDiagBuffer1=0x00000080, pDiagBuffer2=0x00000090
DEBUG: [VPC3_GetDiagBufPtr] Seleccionado pDiagBuffer2
DEBUG: [VPC3_GetDiagBufPtr] Retornando puntero: 0x00000090
DEBUG: [STATE_SWITCH] bDpState=0x02 (WAIT_PRM=0x00, WAIT_CFG=0x01, DATA_EX=0x02)
DEBUG: [STATE_CALC] STATUS_L=0x45, MASK_DP_STATE=0x60, cálculo=((0x45 & 0x60) >> 5)=0x02
DEBUG: [STATE_VERIFY] STATUS_L=0x45, bits 5-6 extraídos y desplazados: 0x02, debería ser DATA_EX=0x02
DEBUG: [STATE_ANALYSIS] STATUS_L=0x45 (binario: 01000101)
DEBUG: [STATE_ANALYSIS] MASK_DP_STATE=0x60 (binario: 01100000)
DEBUG: [STATE_ANALYSIS] STATUS_L & MASK_DP_STATE = 0x40 (binario: 01000000)
DEBUG: [STATE_ANALYSIS] (STATUS_L & MASK_DP_STATE) >> 5 = 0x02 (binario: 00000010)
DEBUG: [STATE_ANALYSIS] Comparación: bDpState=0x02 vs DATA_EX=0x02 (¿iguales? SÍ)
DEBUG: [STATE_DATA_EX] VPC3+ en DATA_EX - comunicación activa
DEBUG: [STATE_CHECK] eDpStateApplReady=4, eDpStateRun=2
DEBUG: [APPLICATION_READY] Ambos estados activos - aplicación funcionando
DEBUG: [ProfibusMain] STATUS antes de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [ProfibusMain] STATUS después de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [STATE_SWITCH] bDpState=0x02 (WAIT_PRM=0x00, WAIT_CFG=0x01, DATA_EX=0x02)
DEBUG: [STATE_CALC] STATUS_L=0x45, MASK_DP_STATE=0x60, cálculo=((0x45 & 0x60) >> 5)=0x02
DEBUG: [STATE_VERIFY] STATUS_L=0x45, bits 5-6 extraídos y desplazados: 0x02, debería ser DATA_EX=0x02
DEBUG: [STATE_ANALYSIS] STATUS_L=0x45 (binario: 01000101)
DEBUG: [STATE_ANALYSIS] MASK_DP_STATE=0x60 (binario: 01100000)
DEBUG: [STATE_ANALYSIS] STATUS_L & MASK_DP_STATE = 0x40 (binario: 01000000)
DEBUG: [STATE_ANALYSIS] (STATUS_L & MASK_DP_STATE) >> 5 = 0x02 (binario: 00000010)
DEBUG: [STATE_ANALYSIS] Comparación: bDpState=0x02 vs DATA_EX=0x02 (¿iguales? SÍ)
DEBUG: [STATE_DATA_EX] VPC3+ en DATA_EX - comunicación activa
DEBUG: [STATE_CHECK] eDpStateApplReady=4, eDpStateRun=2
DEBUG: [APPLICATION_READY] Ambos estados activos - aplicación funcionando
DEBUG: [ProfibusMain] STATUS antes de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [ProfibusMain] STATUS después de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [STATE_SWITCH] bDpState=0x02 (WAIT_PRM=0x00, WAIT_CFG=0x01, DATA_EX=0x02)
DEBUG: [STATE_CALC] STATUS_L=0x45, MASK_DP_STATE=0x60, cálculo=((0x45 & 0x60) >> 5)=0x02
DEBUG: [STATE_VERIFY] STATUS_L=0x45, bits 5-6 extraídos y desplazados: 0x02, debería ser DATA_EX=0x02
DEBUG: [STATE_ANALYSIS] STATUS_L=0x45 (binario: 01000101)
DEBUG: [STATE_ANALYSIS] MASK_DP_STATE=0x60 (binario: 01100000)
DEBUG: [STATE_ANALYSIS] STATUS_L & MASK_DP_STATE = 0x40 (binario: 01000000)
DEBUG: [STATE_ANALYSIS] (STATUS_L & MASK_DP_STATE) >> 5 = 0x02 (binario: 00000010)
DEBUG: [STATE_ANALYSIS] Comparación: bDpState=0x02 vs DATA_EX=0x02 (¿iguales? SÍ)
DEBUG: [STATE_DATA_EX] VPC3+ en DATA_EX - comunicación activa
DEBUG: [STATE_CHECK] eDpStateApplReady=4, eDpStateRun=2
DEBUG: [APPLICATION_READY] Ambos estados activos - aplicación funcionando
DEBUG: [ProfibusMain] STATUS antes de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [ProfibusMain] STATUS después de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [STATE_SWITCH] bDpState=0x02 (WAIT_PRM=0x00, WAIT_CFG=0x01, DATA_EX=0x02)
DEBUG: [STATE_CALC] STATUS_L=0x45, MASK_DP_STATE=0x60, cálculo=((0x45 & 0x60) >> 5)=0x02
DEBUG: [STATE_VERIFY] STATUS_L=0x45, bits 5-6 extraídos y desplazados: 0x02, debería ser DATA_EX=0x02
DEBUG: [STATE_ANALYSIS] STATUS_L=0x45 (binario: 01000101)
DEBUG: [STATE_ANALYSIS] MASK_DP_STATE=0x60 (binario: 01100000)
DEBUG: [STATE_ANALYSIS] STATUS_L & MASK_DP_STATE = 0x40 (binario: 01000000)
DEBUG: [STATE_ANALYSIS] (STATUS_L & MASK_DP_STATE) >> 5 = 0x02 (binario: 00000010)
DEBUG: [STATE_ANALYSIS] Comparación: bDpState=0x02 vs DATA_EX=0x02 (¿iguales? SÍ)
DEBUG: [STATE_DATA_EX] VPC3+ en DATA_EX - comunicación activa
DEBUG: [STATE_CHECK] eDpStateApplReady=4, eDpStateRun=2
DEBUG: [APPLICATION_READY] Ambos estados activos - aplicación funcionando
DEBUG: [ProfibusMain] STATUS antes de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [ProfibusMain] STATUS después de DpAppl_CheckEvIoOut: L=0"

Despues de un tiempo:
"DEBUG: [STATE_CHECK] eDpStateApplReady=4, eDpStateRun=2
DEBUG: [APPLICATION_READY] Ambos estados activos - aplicación funcionando
DEBUG: [ProfibusMain] STATUS antes de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [ProfibusMain] STATUS después de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [STATE_SWITCH] bDpState=0x02 (WAIT_PRM=0x00, WAIT_CFG=0x01, DATA_EX=0x02)
DEBUG: [STATE_CALC] STATUS_L=0x45, MASK_DP_STATE=0x60, cálculo=((0x45 & 0x60) >> 5)=0x02
DEBUG: [STATE_VERIFY] STATUS_L=0x45, bits 5-6 extraídos y desplazados: 0x02, debería ser DATA_EX=0x02
DEBUG: [STATE_ANALYSIS] STATUS_L=0x45 (binario: 01000101)
DEBUG: [STATE_ANALYSIS] MASK_DP_STATE=0x60 (binario: 01100000)
DEBUG: [STATE_ANALYSIS] STATUS_L & MASK_DP_STATE = 0x40 (binario: 01000000)
DEBUG: [STATE_ANALYSIS] (STATUS_L & MASK_DP_STATE) >> 5 = 0x02 (binario: 00000010)
DEBUG: [STATE_ANALYSIS] Comparación: bDpState=0x02 vs DATA_EX=0x02 (¿iguales? SÍ)
DEBUG: [STATE_DATA_EX] VPC3+ en DATA_EX - comunicación activa
DEBUG: [STATE_CHECK] eDpStateApplReady=4, eDpStateRun=2
DEBUG: [APPLICATION_READY] Ambos estados activos - aplicación funcionando
DEBUG: [ProfibusMain] STATUS antes de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [ProfibusMain] STATUS después de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [STATE_SWITCH] bDpState=0x02 (WAIT_PRM=0x00, WAIT_CFG=0x01, DATA_EX=0x02)
DEBUG: [STATE_CALC] STATUS_L=0x45, MASK_DP_STATE=0x60, cálculo=((0x45 & 0x60) >> 5)=0x02
DEBUG: [STATE_VERIFY] STATUS_L=0x45, bits 5-6 extraídos y desplazados: 0x02, debería ser DATA_EX=0x02
DEBUG: [STATE_ANALYSIS] STATUS_L=0x45 (binario: 01000101)
DEBUG: [STATE_ANALYSIS] MASK_DP_STATE=0x60 (binario: 01100000)
DEBUG: [STATE_ANALYSIS] STATUS_L & MASK_DP_STATE = 0x40 (binario: 01000000)
DEBUG: [STATE_ANALYSIS] (STATUS_L & MASK_DP_STATE) >> 5 = 0x02 (binario: 00000010)
DEBUG: [STATE_ANALYSIS] Comparación: bDpState=0x02 vs DATA_EX=0x02 (¿iguales? SÍ)
DEBUG: [STATE_DATA_EX] VPC3+ en DATA_EX - comunicación activa
DEBUG: [STATE_CHECK] eDpStateApplReady=4, eDpStateRun=2
DEBUG: [APPLICATION_READY] Ambos estados activos - aplicación funcionando
DEBUG: [ProfibusMain] STATUS antes de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [ProfibusMain] STATUS después de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
VPC3+S REGISTERS:
STATUS_L   (0x04): 0x45
STATUS_H   (0x05): 0xE3
MODE_REG_1 (0x07): 0x37
CONTROL_REG(0x08): 0x1B
MODE_REG_2 (0x09): 0x02
INT_REG_L  (0x0A): 0x72
INT_REG_H  (0x0B): 0x03
CFG_PTR    (0x34): 0x9E

==============================================
PROFIBUS STATE: STATUS_L = 0x45 -> PASSIVE_IDLE
==============================================
DEBUG: [STATE_SWITCH] bDpState=0x02 (WAIT_PRM=0x00, WAIT_CFG=0x01, DATA_EX=0x02)
DEBUG: [STATE_CALC] STATUS_L=0x45, MASK_DP_STATE=0x60, cálculo=((0x45 & 0x60) >> 5)=0x02
DEBUG: [STATE_VERIFY] STATUS_L=0x45, bits 5-6 extraídos y desplazados: 0x02, debería ser DATA_EX=0x02
DEBUG: [STATE_ANALYSIS] STATUS_L=0x45 (binario: 01000101)
DEBUG: [STATE_ANALYSIS] MASK_DP_STATE=0x60 (binario: 01100000)
DEBUG: [STATE_ANALYSIS] STATUS_L & MASK_DP_STATE = 0x40 (binario: 01000000)
DEBUG: [STATE_ANALYSIS] (STATUS_L & MASK_DP_STATE) >> 5 = 0x02 (binario: 00000010)
DEBUG: [STATE_ANALYSIS] Comparación: bDpState=0x02 vs DATA_EX=0x02 (¿iguales? SÍ)
DEBUG: [STATE_DATA_EX] VPC3+ en DATA_EX - comunicación activa
DEBUG: [STATE_CHECK] eDpStateApplReady=4, eDpStateRun=2
DEBUG: [APPLICATION_READY] Ambos estados activos - aplicación funcionando
DEBUG: [ProfibusMain] STATUS antes de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
DEBUG: [ProfibusMain] STATUS después de DpAppl_CheckEvIoOut: L=0x45, H=0xE3
"